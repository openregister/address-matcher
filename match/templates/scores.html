{% extends "base.html" %}


{% block content %}

<h1 class="heading-xlarge">Stats</h1>

<a href="#users">Top users</a>,
<a href="#coverage">Address stats</a>


<h2 id="users" class="heading-large">Top users</h2>

<table>
    <thead>
        <tr><th>Name</th><th>Matches</th><th>
    </thead>
    <tbody>
        {% for user in users %}
            <tr><td>{{ user.name }}</td><td>{{ user.score }}</td></tr>
        {% endfor %}
    </tbody>
</table>

<h2 id="addresses" class="heading-large">Address stats</h2>

<ul>
    <li>{{ nb_addresses }} addresses</li>
    <li>{{ nb_matches }} user matches</li>
    <li>{{ nb_pass }} matches failed ({{ nb_pass_ratio }}% of all matches)</li>
</ul>

<h3 class="heading-medium">Match coverage</h3>

<div id="chart_div"></div>

<!--Load the AJAX API-->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

 // Load the Visualization API and the corechart package.
 google.charts.load('current', {'packages':['corechart']});

 // Set a callback to run when the Google Visualization API is loaded.
 google.charts.setOnLoadCallback(drawChart);

 // Callback that creates and populates a data table,
 // instantiates the pie chart, passes in the data and
 // draws it.
 function drawChart() {

   // Create the data table.
   var data = new google.visualization.DataTable();
   data.addColumn('string', 'Matched');
   data.addColumn('number', 'Number of addresses');
   data.addRows({{ occurrences }});

   // Set chart options
   var options = {'title':'Ratio of addresses matched (once or more)',
                  'width':400,
                  'height':300};

   // Instantiate and draw our chart, passing in some options.
   var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
   chart.draw(data, options);
 }
</script>


{% endblock %}
